<script type="text/javascript" src="/assets/jquery.colorbox-min.js"></script>

<div id="sidebar">
  <%= render 'show_sidebar' %>
</div>

<div id="main_content">
  <div class="header">
    <%= render 'header' %>
  </div>
  <div id="show-content">
    <div class="title">
      <h2><%= @pension.title %></h2>
      <div class="fb-like" data-href="<%= request.url %>" data-send="false" data-layout="button_count" data-width="450" data-show-faces="false"></div>
      <%= link_to '펜션 바로가기', @pension.url, :target => '_blank' %>
    </div>
    <div class="line-green"></div>
    <div class="body">
      <div class="pension-photo">
        <%= image_tag 'pension_01.jpg' %>
      </div>
      <div class="pension-detail">
        <div id="pension-info-type"><%= @pension.roomstructure %></div>
        <div id="pension-info-faci"><%= @pension.facilities.split(',').join(', ') %></div>
        <div id="pension-info-theme"><%= @pension.themes.collect {|x| x.title}.join(', ') %></div>
        <div id="pension-info-start">
          <form>
            <div id="findway-box">
              <input type="text" value="1박 2일 추월산 펜션까지의 길을 찾아드립니다." name="findway" id="findway-word">
              <input type="image" src="/assets/header_searchbox_button.png" id="findway-button" class="openMask" />
            </div>
          </form>
        </div>
        <div id="pension-info-addr"><%= @pension.addr %></div>
        <div id="pension-info-price"><%= @pension.min_price / 10000 %> ~ <%= @pension.max_price / 10000 %> 만원</div>
        <div id="pension-info-phone">031-454-5484</div>
        <%= javascript_tag "$(document).ready(function(){$('.room_btn').colorbox();})" %>
        <%= link_to content_tag(:div, '', :id => 'pension-info-room'), pension_rooms_path(@pension), :class => 'room_btn' if @pension.rooms.count > 0 %>
      </div>
    </div>

    <div id="show-footer">
		<%= render 'map' %>
      <div class="line-green"></div>
    </div>
    <div id="show-review">
      <div id="pension-review-title"></div>
      <fb:comments-count href="<%= request.url %>"></fb:comments-count>개의 댓글
      <fb:comments href="<%= request.url %>" num-posts="5" width="709"></fb:comments>
      <script type="text/javascript" charset="utf-8">
        FB.Event.subscribe('comment.create', function(response) {
          $.get('/pensions/update_comments_count', {id:<%= @pension.id %>});
        });
        FB.Event.subscribe('comment.remove', function(response) {
          $.get('/pensions/update_comments_count', {id:<%= @pension.id %>, remove:true});
        });
        FB.Event.subscribe('edge.create', function(response) {
          $.get('/pensions/update_like_count', {id:<%= @pension.id %>});
        });
        FB.Event.subscribe('edge.remove', function(response) {
          $.get('/pensions/update_like_count', {id:<%= @pension.id %>, remove:true});
        });
      </script>
    </div>

    <div id="blog-review">
      <div id="blog-review-title"></div>
      <div id="blog-review-list">
        <ul>
        <% @blog_reviews.each do |item| %>
          <li>
            <%= link_to raw(item.title), item.link, :target => :blank %>
            <p><%= raw item.desc %></p>
          </li>
        <% end %>
        </ul>
        <%= paginate @blog_reviews %>
      </div>
    </div>
  </div>
</div>
